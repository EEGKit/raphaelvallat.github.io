<!DOCTYPE HTML>
<!--
	Read Only by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Raphael Vallat</title>
		<meta charset="utf-8" />
		<meta name="description" content="Personal website of Raphael Vallat" />
		<meta name="author" content="Raphael Vallat">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
	</head>
	<body>

		<!-- Header -->
			<section id="header">
				<header>
					<span class="image avatar"><img src="images/avatar.jpg" alt="" /></span>
					<h1 id="logo">Raphael Vallat</h1>
					<p>PhD student in Neuroscience <br> Lyon Neuroscience Research Center</p>
				</header>
				<nav id="nav">
					<ul>
						<li><a href="index.html#one">About</a></li>
						<li><a href="index.html#two">Academics</a></li>
						<li><a href="index.html#three">Publications</a></li>
						<li><a href="index.html#four" class="active">Tutorials</a></li>
					</ul>
				</nav>
				<footer>
					<ul class="icons">
						<!-- <li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li> -->
						<!-- <li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li> -->
						<!-- <li><a href="#" class="icon fa-instagram"><span class="label">Instagram</span></a></li> -->
						<li><a href="https://github.com/raphaelvallat" class="icon fa-github"><span class="label">Github</span></a></li>
						<li><a href="mailto:raphael.vallat@inserm.fr" class="icon fa-envelope"><span class="label">Email</span></a></li>
					</ul>
				</footer>
			</section>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
					
					<div class="container">

						<section>
							<header>
								<h3>SleepViz : A tool for visualisation of polysomnographic data</h3>
							</header>
						</section>
						
						<section>
						
						<p>SleepViz is a very simple and naive Matlab-based interface for visualisation of polysomnographic data. It stemmed from a need to have a quick overview of both EEG data and the corresponding hypnogram and spectrogram on a single window. </p>	

						
						<ul class="feature-icons">
						<li class="fa-code">Link to my <a href="https://github.com/raphaelvallat/SleepViz">SleepViz GitHub repository</a></li><br>
						</ul>
						<ul class="feature-icons">
						<li class="fa-spinner">The tutorial is not finished yet..!</li>
						</ul>
											
						
						</section>
						
						<hr />
						<span class="image fit"><img src="images/sleepviz_logo.png" alt="" /></span>
						<span class="image fit"><img src="images/tutorials/sleepviz/main_interface.png" alt="" />
						<figcaption>Screenshot of SleepViz GUI</figcaption>
						</span>
						
						<hr />
						
						<h4>Running SleepViz</h4>
						
						<p>Once you have downloaded sleepviz and added it to your Matlab path, just type <b>sleepviz</b> to start the program. In the current version, SleepViz allows input from 2 different formats:
						<ul>
							<li>edf (using edfRead function by Brett Shoelson, available on <a href="https://fr.mathworks.com/matlabcentral/fileexchange/31900-edfread">Matlab file exchange</a>)</li>
							<li>eeg (<a href="http://elan.lyon.inserm.fr/">Lyon Neuroscience Research Center in house file format)</a></li>
						</ul>

						After selecting the channels you want to plot, the following windows opens:</p>
						
						<span class="image"><img src="images/tutorials/sleepviz/sleepviz_params.png" alt="" />
						</span>
						
						<ul>
							<li><b>Apply downsampling to 100 Hz:</b> by default, SleepViz will downsample your data to 100 Hz to accelerate the computing of the spectrogram. If you prefer not to resample your data, just put 0 in the textbox.</li><br>
							<li><b>Plot spectrogram:</b> requires <a href="https://fr.mathworks.com/products/signal.html">Signal Processing Toolbox</a>. Plot a spectrogram on specified channel using short-time Fourier transform. Spectrogram is  a visual representation of the frequencies spectrum over time. It is especially useful for the scoring of sleep stages which have all different spectral signatures. The default segmentation windows is 10 seconds with an overlap of 0.9. This latter parameter is particularly time-consuming and I recommand putting a lower value if you do not have a powerful computer.</li><br>
							<li><b>Plot hypnogram:</b> requires a hypnogram file either in .hyp format (Elan in house format) or .txt. In that case it must contains one column of integer crresponding to the sleep stages. By default, sleepviz will resample the hypnogram to get one value per second. <br>The default hypnogram format of SleepViz is: Wake=0, N1=1, N2=2, N3=3, REM=4, Art=-1 (based on Iber 2007 guidelines).</li>
						</ul>
						
						After selecting the spectrogram channel and hypnogram files, the main interface of sleepviz will launch. <br> The <b>slider bar</b> at the bottom of the window allow you to move forward or backward (30 sec epochs) in the EEG data. <br>The <b>Amplitude</b> button allows you to modify the amplitude (in mV) of each individual channels. <br>Finally, the <b>Tools</b> button open a new window with several algorithms detailed below. 
						
						<hr />

						<h4>REM Auto-Detect</h4>
						
						<p>A simple semi-automatic algorithm for the detection of Rapid Eye Movements (saccades). <br><br> The method is the following: <br> 
						 1) <b>Signal smoothing</b> using either a moving average with a window of 100 ms or a bandpass filter (0.1 - 3 Hz, see Andrillon 2015). 
						 <br>2) Computing of the <b>first derivative</b> of the smoothed signal using a 40 ms step. I chose a 40 ms windows since most of naturally occurring human saccades have magnitudes of 15 degrees or less and last thus no more than 30 – 40 ms (the maximum velocity of a saccade is above 500°/sec, see (Bahill et al., 1975). <br>3) Apply a <b>threshold</b> (mean + X standard deviations) on the derivative to allow for an optimal detection of REMs. <br>4) The total number of REMs is then defined as the <b>sum of non-concomitant REMs</b> detected in the two components during REM sleep.</p>
						 <p>
						 When you click on REMs detection, the program asks you to select 2 EOG channels. I would recommend using artefact-free EOG signal (extracted for example using ICA) for a better detection of saccades. Then the following windows appears: </p>
						
												
						<span class="image"><img src="images/tutorials/sleepviz/rems_param.png" alt="" /></span>
						
						<p>
						<ul>
							<li><b>REM Sleep:</b> uses only epochs scored as REM sleep for the computation of REMs. Requires a hypnogram file.</li>
							<li><b>Filter Type:</b> either a moving average (100 ms windows) or bandpass filter (0.1 - 3 Hz). Bandpass is generally more conservative.</li>
							<li><b>Threshold:</b> threshold is the specified number of standard deviations of the derivative signal. Each supra-threshold cluster will be considered as a unique rapid eye movements. </li>
						</ul>
						
						After having specified the desired parameters, the following windows will open to allow you for a visual check of the detected REMs. Once again you can move forward or backward using the slider bar. The textbox on the left indicates the number of REMs detected on each EOG components as well as the final number of unique REMs. It is then up to you to change the threshold in order to optimize the detection</p>
						
						<span class="image fit"><img src="images/tutorials/sleepviz/rems_detection.png" alt="" /></span>
						
						<p>The script also create a .mat file in the data folder which contains analysis info and results</p>
<pre><code>
RAPID EYE MOVEMENTS AUTO-DETECTION
-----------------------------------------
ANALYSIS INFO
EEG File 	:	excerpt1.edf
Duration 	:	30 minutes
Filter type	:	moving [100 samples]
Threshold 	:	3
Derivative 	:	40 ms

RESULTS
Number 		:	185 
Density 	:	6.17 REMs / minutes
Outfile		:	C:\Users\Raphael\Desktop\These\GitHub\SleepViz\examples\DREAMS\REMs_detection_excerpt1_filter_moving_thresh_3.mat
-----------------------------------------------
</code></pre>

					<ul class="feature-icons">
					<li class="fa-check">The excellent <a href="http://www.tcts.fpms.ac.be/~devuyst/Databases/DatabaseREMs/">DREAMS database</a>, in addition with providing free polysomnographic data and corresponding hypnograms also provides the number of REMs visually scored by an expert. Our method with the default parameters yielded 185 REMs (see output above), a figure quite consistent with the 157 visually-scored REMs!</li><br>
					</ul>
					<p>
					
					<hr />
					
					<h4>Compute Sleep Stats</h4>
					
					<p>SleepViz allows to compute sleep statistics of the current hypnogram. Just click Compute Sleep Stats to calculate the following parameters:</p>
					
					<span class="image"><img src="images/tutorials/sleepviz/sleep_stats.png" alt="" /></span>
						
					<hr />
					
					<h4>ECG Analysis</h4>
					
					<p>The ECG Analysis tool extracts the mean BPM across the entire record using the findpeaks function from Signal Processing Toolbox. Once you clicked the button, the following window appears:</p>
					
					<span class="image"><img src="images/tutorials/sleepviz/ecg_params.png" alt="" /></span>
					<br>
					<p>Once you specified the ECG channel and desired parameters, a graphical interface opens to let you explore the detected peaks in ECG signal. </p>
					<span class="image fit"><img src="images/tutorials/sleepviz/ecg.png" alt="" /></span>
					
					<hr />
					
					<h4>Filter signal</h4>

					<p>A simple bandpass filter.</p>
					
					<span class="image fit"><img src="images/tutorials/sleepviz/filter.png" alt="" />
					<figcaption>Signal filtered in band 11 - 16 Hz</figcaption>
					</span>
					
					</div>

				<!-- Footer -->
					<section id="footer">
						<div class="container">
							<ul class="copyright">
								<li>&copy; Raphael Vallat </li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li><li>Banner image: Nicolas Roerich</li>
							</ul>
						</div>
					</section>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollzer.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>

	</body>
</html>